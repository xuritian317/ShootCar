var CDB={debugMode:!1,gameId:0,channelId:0,uid:0,token:"",uniqueKey:"",sdkVersion:"1.9",channelType:{WX:1002,FACEBOOK:7001,MQQ:2003,OPPO:8001,vivo:9001,LYH5:10001},getServerTime(e){var r=CDB._url()+CDB._linkInfo.keyServerTime;CDB._check(e,CDB._linkInfo.keyServerTime)||CDB._httpRequest(r,e,"GET")},login(e){if(!CDB._check(e,CDB._linkInfo.keyLogin)){e.data=e.data?e.data:"";var r=CDB._url()+CDB._linkInfo.keyLogin;CDB.gameId=e.gameId,CDB.channelId=e.channelId,CDB._httpRequest(r,e,null,function(r){if(0==r.state&&r.info){CDB.uid=r.info.uid,CDB.token=r.info.token,CDB.uniqueKey=r.info.uniqueKey;var t=CDB._getPlatObject();t&&(t.cdb.uid=CDB.uid,t.cdb.token=CDB.token,t.cdb.openId=r.info.openId||e.data.openId||"",t.cdb.uniqueKey=CDB.uniqueKey)}CDB._logInfo()})}},getWxDecryptionData(e){if("object"==typeof e){e.uniqueKey=CDB.uniqueKey,e.appid=CDB.gameId.toString(),e.channel=CDB.channelId.toString();var r=CDB._serviceUrl()+CDB._linkInfo.keyGetWxDecryptionData;if(CDB._check(e,CDB._linkInfo.keyGetWxDecryptionData))return;CDB._httpRequest(r,e)}else console.error("CDB getWxUnionKey ERROR params Type")},setPrivateData(e){var r=CDB._url()+CDB._linkInfo.keySavePrivateData;CDB._check(e,CDB._linkInfo.keySavePrivateData)||CDB._httpRequest(r,e)},setPrivateDatas(e){var r=CDB._url()+CDB._linkInfo.keySavePrivateDatas;CDB._check(e,CDB._linkInfo.keySavePrivateDatas)||CDB._httpRequest(r,e)},setPublicData(e){var r=CDB._url()+CDB._linkInfo.keySavePublicData;CDB._check(e,CDB._linkInfo.keySavePublicData)||CDB._httpRequest(r,e)},setOtherData(e){var r=CDB._url()+CDB._linkInfo.keySaveOhterData;CDB._check(e,CDB._linkInfo.keySaveOhterData)||CDB._httpRequest(r,e)},getUserData(e){var r=CDB._url()+CDB._linkInfo.keyGetUserData;CDB._check(e,CDB._linkInfo.keyGetUserData)||CDB._httpRequest(r,e)},getUserDatas(e){var r=CDB._url()+CDB._linkInfo.keyGetUserDatas;CDB._check(e,CDB._linkInfo.keyGetUserDatas)||CDB._httpRequest(r,e)},getUsers(e){var r=CDB._url()+CDB._linkInfo.keyGetUsers;CDB._check(e,CDB._linkInfo.keyGetUsers)||CDB._httpRequest(r,e)},deleteSelfDatasFromOthers(e){var r=CDB._url()+CDB._linkInfo.keyDeleteSelfDatasFromOthers;CDB._check(e,CDB._linkInfo.keyDeleteSelfDatasFromOthers)||CDB._httpRequest(r,e)},getRankListData(e){var r=CDB._url()+CDB._linkInfo.keyGetRankListData;CDB._check(e,CDB._linkInfo.keyGetRankListData)||CDB._httpRequest(r,e)},getMyRankData(e){var r=CDB._url()+CDB._linkInfo.keyGetMyRankData;CDB._check(e,CDB._linkInfo.keyGetMyRankData)||CDB._httpRequest(r,e)},setWorldRankData(e){var r=CDB._url()+CDB._linkInfo.keyAppendRankData;CDB._check(e,CDB._linkInfo.keyAppendRankData)||CDB._httpRequest(r,e)},getOthersData(e){var r=CDB._url()+CDB._linkInfo.keyGetOthersData;CDB._check(e,CDB._linkInfo.keyGetOthersData)||CDB._httpRequest(r,e)},getLocationInfo(e){var r=CDB._url()+CDB._linkInfo.keyGetLocation;CDB._check(e,CDB._linkInfo.keyGetLocation)||CDB._httpRequest(r,e)},getRandomUserInfos(e){var r=CDB._url()+CDB._linkInfo.keyGetRandomUsers;CDB._check(e,CDB._linkInfo.keyGetRandomUsers)||CDB._httpRequest(r,e)},updateWxUserInfo(e){var r=CDB._url()+CDB._linkInfo.keyUpdateUserInfo;CDB._check(e,CDB._linkInfo.keyUpdateUserInfo)||CDB._httpRequest(r,e)},deleteUserDatas(e){var r=CDB._url()+CDB._linkInfo.keyDeleteSelfDatas;CDB._check(e,CDB._linkInfo.keyDeleteSelfDatas)||CDB._httpRequest(r,e)},calculateUserData(e){var r=CDB._url()+CDB._linkInfo.keyCalculateData;CDB._check(e,CDB._linkInfo.keyCalculateData)||CDB._httpRequest(r,e)},calculateUserDatas(e){var r=CDB._url()+CDB._linkInfo.keyCalculateDatas;CDB._check(e,CDB._linkInfo.keyCalculateDatas)||CDB._httpRequest(r,e)},getOthersKeysData(e){var r=CDB._url()+CDB._linkInfo.keyGetOthersKeysData;CDB._check(e,CDB._linkInfo.keyGetOthersKeysData)||CDB._httpRequest(r,e)},verification(e){var r=CDB._url()+CDB._linkInfo.keyVerification;CDB._check(e,CDB._linkInfo.keyVerification)||CDB._httpRequest(r,e)},_check(e,r){var t=function(e){return null==e||void 0==e},a=function(e){return"number"==typeof e},n=function(e){return"string"==typeof e},o=function(e){return"object"==typeof e};if(r==CDB._linkInfo.keyLogin){if(t(e.gameId)||t(e.channelId)||t(e.platId)||t(e.timestamps))return console.error("CDB Error Params : "+JSON.stringify(e)),!0;if(!(a(e.gameId)&&a(e.channelId)&&a(e.platId)&&n(e.timestamps)))return console.error("CDB Error Params Type : "+JSON.stringify(e)),!0}else if(r==CDB._linkInfo.keySavePrivateData){if(t(e.key)||t(e.value))return console.error("CDB Error Params : "+JSON.stringify(e)),!0;if(!a(e.key)||!n(e.value))return console.error("CDB Error Params Type : "+JSON.stringify(e)),!0}else if(r==CDB._linkInfo.keySavePrivateDatas){if(t(e.data))return console.error("CDB Error Params : "+JSON.stringify(e)),!0;if(!o(e.data))return console.error("CDB Error Params Type : "+JSON.stringify(e)),!0}else if(r==CDB._linkInfo.keyGetUserData){if(t(e.key)||t(e.sdType))return console.error("CDB Error Params : "+JSON.stringify(e)),!0;if(!a(e.key)||!a(e.sdType))return console.error("CDB Error Params Type : "+JSON.stringify(e)),!0}else if(r==CDB._linkInfo.keyGetUserDatas){if(t(e.keys)||t(e.sdType))return console.error("CDB Error Params : "+JSON.stringify(e)),!0;if(!o(e.keys)||!a(e.sdType))return console.error("CDB Error Params Type : "+JSON.stringify(e)),!0}else if(r==CDB._linkInfo.keySavePublicData){if(t(e.key)||t(e.score))return console.error("CDB Error Params : "+JSON.stringify(e)),!0;if(!a(e.key)||!a(e.score))return console.error("CDB Error Params Type : "+JSON.stringify(e)),!0}else if(r==CDB._linkInfo.keyGetOthersData){if(t(e.key)||t(e.otherUids))return console.error("CDB Error Params : "+JSON.stringify(e)),!0;if(!a(e.key)||!o(e.otherUids))return console.error("CDB Error Params Type : "+JSON.stringify(e)),!0}else if(r==CDB._linkInfo.keySaveOhterData){if(t(e.key)||t(e.otherUid)||t(e.value))return console.error("CDB Error Params : "+JSON.stringify(e)),!0;if(!a(e.key)||!n(e.otherUid)||!n(e.value))return console.error("CDB Error Params Type : "+JSON.stringify(e)),!0}else if(r==CDB._linkInfo.keyAppendRankData){if(t(e.key)||t(e.score))return console.error("CDB Error Params : "+JSON.stringify(e)),!0;if(!a(e.key)||!a(e.score))return console.error("CDB Error Params Type : "+JSON.stringify(e)),!0}else if(r==CDB._linkInfo.keyGetRankListData){if(t(e.key))return console.error("CDB Error Params : "+JSON.stringify(e)),!0;if(!a(e.key))return console.error("CDB Error Params Type : "+JSON.stringify(e)),!0;if(e.otherUserDataKeys&&!o(e.otherUserDataKeys))return console.error("CDB Error Params Type : "+JSON.stringify(e)),!0}else if(r==CDB._linkInfo.keyGetMyRankData){if(t(e.key))return console.error("CDB Error Params : "+JSON.stringify(e)),!0;if(!a(e.key))return console.error("CDB Error Params Type : "+JSON.stringify(e)),!0;if(e.otherUserDataKeys&&!o(e.otherUserDataKeys))return console.error("CDB Error Params Type : "+JSON.stringify(e)),!0}else if(r==CDB._linkInfo.keyGetUsers){if(t(e.otherUids))return console.error("CDB Error Params : "+JSON.stringify(e)),!0;if(!o(e.otherUids))return console.error("CDB Error Params Type : "+JSON.stringify(e)),!0}else if(r==CDB._linkInfo.keyGetRandomUsers){if(!t(e.num)&&!a(e.num))return console.error("CDB Error Params Type : "+JSON.stringify(e)),!0}else if(r==CDB._linkInfo.keyDeleteSelfDatasFromOthers){if(t(e.key)||t(e.values))return console.error("CDB Error Params : "+JSON.stringify(e)),!0;if(!a(e.key)||!o(e.values))return console.error("CDB Error Params Type : "+JSON.stringify(e)),!0}else if(r==CDB._linkInfo.keyDeleteSelfDatas){if(0==CDB.debugMode)return console.error("CDB Can not use DELETE DATA API by Release"),!0;if(e.sdTypes&&!Array.isArray(e.sdTypes))return console.error("CDB Error Params Type : "+JSON.stringify(e)),!0}else if(r==CDB._linkInfo.keyCalculateData){if(t(e.uid)||t(e.key))return console.error("CDB Error Params : "+JSON.stringify(e)),!0;if(!a(e.uid)||!a(e.key))return console.error("CDB Error Params Type : "+JSON.stringify(e)),!0}else if(r==CDB._linkInfo.keyCalculateDatas){if(t(e.uid)||t(e.data))return console.error("CDB Error Params : "+JSON.stringify(e)),!0;if(!a(e.uid)||!Array.isArray(e.data))return console.error("CDB Error Params Type : "+JSON.stringify(e)),!0}else if(r==CDB._linkInfo.keyGetWxDecryptionData){if(t(e.data)||t(e.uniqueKey))return console.error("CDB Error Params : "+JSON.stringify(e)),!0;if(!n(e.data)||!n(e.uniqueKey))return console.error("CDB Error Params Type : "+JSON.stringify(e)),!0}else if(r==CDB._linkInfo.keyUpdateUserInfo){if("undefined"==typeof wx)return console.error("CDB Error UpdateUserInfo is Wechat Only : "+JSON.stringify(e)),!0;if(t(e.nickname)||t(e.avatarUrl))return console.error("CDB Error Params : "+JSON.stringify(e)),!0;if(!n(e.nickname)||!n(e.avatarUrl))return console.error("CDB Error Params Type : "+JSON.stringify(e)),!0}else if(r==CDB._linkInfo.keyGetOthersKeysData){if(t(e.otherUids)||t(e.keys))return console.error("CDB Error Params : "+JSON.stringify(e)),!0;if(!o(e.otherUids)||!o(e.keys))return console.error("CDB Error Params Type : "+JSON.stringify(e)),!0}else if(r==CDB._linkInfo.keyVerification){if(t(e.name)||t(e.idCard))return console.error("CDB Error Params : "+JSON.stringify(e)),!0;if(!n(e.name)||!n(e.idCard))return console.error("CDB Error Params : "+JSON.stringify(e)),!0;if(e.name.length<=1||15!=e.idCard.length&&18!=e.idCard.length)return console.error("CDB Error Params : "+JSON.stringify(e)),!0}return!1},_linkInfo:{keyServerTime:"/api/userCloudData/time",keyLogin:"/api/user/login",keySavePrivateData:"/api/userCloudData/setSelfNormalData",keySavePrivateDatas:"/api/userCloudData/setSelfMultipleData",keyGetUserData:"/api/userCloudData/getSelfData",keyGetUserDatas:"/api/userCloudData/getSelfDatas",keySavePublicData:"/api/userCloudData/setSelfScoreOtherReadData",keyGetOthersData:"/api/userCloudData/getOthersData",keySaveOhterData:"/api/userCloudData/appendOtherSetData",keyAppendRankData:"/api/userCloudData/appendRankList",keyGetRankListData:"/api/userCloudData/getRankList",keyGetMyRankData:"/api/userCloudData/getRank",keyGetUsers:"/api/user/getUsers",keyGetRandomUsers:"/api/user/getRandomUsers",keyDeleteSelfDatasFromOthers:"/api/userCloudData/deleteSelfDatasFromOthers",keyDeleteSelfDatas:"/cdb/test/resetUserData",keyCalculateData:"/api/userCloudData/calculateSingleKey",keyCalculateDatas:"/api/userCloudData/calculateMultipleKeys",keyGetWxDecryptionData:"/decryption",keyGetLocation:"/api/userCloudData/getLocation",keyUpdateUserInfo:"/api/userCloudData/refreshUserBasicInfo",keyGetOthersKeysData:"/api/userCloudData/getOthersKeysData",keyVerification:"/api/userCloudData/realCheck"},_url:()=>CDB.debugMode?"https://test.gw.leuok.com/gl-ms-single-server":"https://gw.lightlygame.com/gl-ms-single-server",_serviceUrl:()=>CDB.debugMode?"https://test.gw.leuok.com/gl-ms-minigame-service":"https://gw.lightlygame.com/gl-ms-minigame-service",_httpRequest(e,r,t,a){var n=CDB._getPlatObject()||{cdb:{}};try{t=t||"POST";var o=new XMLHttpRequest;o.open(t,e),o.onload=function(){if(this.status>=200&&this.status<300){var e=JSON.parse(o.response);0==e.state?(a&&a(e),r.success&&r.success(e)):r.fail&&r.fail(e),r.complete&&r.complete(e)}else{var t={status:this.status,statusText:o.statusText};r.fail&&r.fail(t),r.complete&&r.complete(t)}},o.onerror=function(){var e={status:this.status,statusText:o.statusText};r.fail&&r.fail(e),r.complete&&r.complete(e)},o.setRequestHeader("gameId",CDB.gameId.toString()),o.setRequestHeader("channelId",CDB.channelId.toString()),o.setRequestHeader("uid",n.cdb.uid||CDB.uid.toString()),o.setRequestHeader("token",n.cdb.token||CDB.token),o.setRequestHeader("Content-Type","application/json"),o.send(JSON.stringify(r))}catch(e){console.error("\u5ba2\u6237\u7aef\u53d1\u9001\u5931\u8d25:"+e)}},_logInfo(){console.log("[CDB INFO] gameId: "+CDB.gameId+" channelId: "+CDB.channelId+" uid: "+CDB.uid+" token: "+CDB.token)},_getPlatObject:()=>"object"==typeof wx?wx.leuok:"object"==typeof BK?BK.leuok:"object"==typeof qg?qg.leuok:"object"==typeof qq?qq.leuok:"object"==typeof window?window.leuok:void 0};window.CDB=CDB;